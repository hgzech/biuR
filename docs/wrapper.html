---

title: Wrapper


keywords: fastai
sidebar: home_sidebar

summary: "A wrapper for rpy2, which somewhat mimics the ipython magic functions."
description: "A wrapper for rpy2, which somewhat mimics the ipython magic functions."
nb_path: "notebooks/01_wrapper.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: notebooks/01_wrapper.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="R" class="doc_header"><code>class</code> <code>R</code><a href="https://github.com/hgzech/biuR/tree/main/biuR/wrapper.py#L13" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>R</code>()</p>
</blockquote>
<p>A wrapper for rpy2, which somewhat mimics the ipython magic functions.
Basically, it handles the automatic conversion of some python objects to R objects.
Further, it allows you to automatically push python objects, call code and get converted objects back to python.</p>
<h2 id="Example-usage:">Example usage:<a class="anchor-link" href="#Example-usage:"> </a></h2><p>r = biu.R()
x = pd.DataFrame([[1,2,3],[4,5,6]])
r.push(x=x)
r('y = x * 2')
y = r.get('y')</p>
<h2 id="Or,-altogether:">Or, altogether:<a class="anchor-link" href="#Or,-altogether:"> </a></h2><p>y = r('y=x*2', push=dict(x=x), get='y')</p>
<h2 id="Doing-a-lot-at-the-same-time:">Doing a lot at the same time:<a class="anchor-link" href="#Doing-a-lot-at-the-same-time:"> </a></h2><p>y, z = r('''
    y = x * 2
    z = x + 2
    ''', push=dict(x=x), get=['y', 'z'])</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">r</span> <span class="o">=</span> <span class="n">R</span><span class="p">()</span>
<span class="n">r</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">    dist &lt;- rnorm(n, mean, var)</span>
<span class="s2">    print(mean(dist))</span>
<span class="s2">&quot;&quot;&quot;</span><span class="p">,</span> <span class="n">get</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>R[write to console]: Error in rnorm(n, mean, var) : object &#39;n&#39; not found

</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_text output_error">
<pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">RRuntimeError</span>                             Traceback (most recent call last)
<span class="ansi-green-fg">/var/folders/16/2wxbnpk5321f8g40bxf0ht_h0000gn/T/ipykernel_62727/2587981583.py</span> in <span class="ansi-cyan-fg">&lt;module&gt;</span>
<span class="ansi-green-intense-fg ansi-bold">      1</span> r <span class="ansi-blue-fg">=</span> R<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-fg">----&gt; 2</span><span class="ansi-red-fg"> r(&#34;&#34;&#34;
</span><span class="ansi-green-intense-fg ansi-bold">      3</span>     dist <span class="ansi-blue-fg">&lt;</span><span class="ansi-blue-fg">-</span> rnorm<span class="ansi-blue-fg">(</span>n<span class="ansi-blue-fg">,</span> mean<span class="ansi-blue-fg">,</span> var<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">      4</span>     print<span class="ansi-blue-fg">(</span>mean<span class="ansi-blue-fg">(</span>dist<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">      5</span> &#34;&#34;&#34;, get=False)

<span class="ansi-green-fg">/var/folders/16/2wxbnpk5321f8g40bxf0ht_h0000gn/T/ipykernel_62727/2183228038.py</span> in <span class="ansi-cyan-fg">__call__</span><span class="ansi-blue-fg">(self, cmd, push, get)</span>
<span class="ansi-green-intense-fg ansi-bold">    151</span>         <span class="ansi-green-fg">if</span> get <span class="ansi-green-fg">is</span> <span class="ansi-green-fg">not</span> <span class="ansi-green-fg">None</span><span class="ansi-blue-fg">,</span> it returns a value<span class="ansi-blue-fg">,</span> <span class="ansi-green-fg">as</span> specified by the get<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span> function<span class="ansi-blue-fg">.</span>
<span class="ansi-green-intense-fg ansi-bold">    152</span>         &#34;&#34;&#34;
<span class="ansi-green-fg">--&gt; 153</span><span class="ansi-red-fg">         </span><span class="ansi-green-fg">return</span> self<span class="ansi-blue-fg">.</span>exec<span class="ansi-blue-fg">(</span>cmd<span class="ansi-blue-fg">,</span> push<span class="ansi-blue-fg">,</span> get<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    154</span>     <span class="ansi-red-fg">#edef</span>
<span class="ansi-green-intense-fg ansi-bold">    155</span> 

<span class="ansi-green-fg">/var/folders/16/2wxbnpk5321f8g40bxf0ht_h0000gn/T/ipykernel_62727/2183228038.py</span> in <span class="ansi-cyan-fg">exec</span><span class="ansi-blue-fg">(self, cmd, push, get)</span>
<span class="ansi-green-intense-fg ansi-bold">    122</span>         self<span class="ansi-blue-fg">.</span>push<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">**</span>push<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    123</span> 
<span class="ansi-green-fg">--&gt; 124</span><span class="ansi-red-fg">         </span>res <span class="ansi-blue-fg">=</span> rpy2<span class="ansi-blue-fg">.</span>robjects<span class="ansi-blue-fg">.</span>r<span class="ansi-blue-fg">(</span>cmd<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    125</span> 
<span class="ansi-green-intense-fg ansi-bold">    126</span>         <span class="ansi-green-fg">if</span> isinstance<span class="ansi-blue-fg">(</span>get<span class="ansi-blue-fg">,</span> bool<span class="ansi-blue-fg">)</span> <span class="ansi-green-fg">and</span> get<span class="ansi-blue-fg">:</span>

<span class="ansi-green-fg">~/opt/miniconda3/envs/biur/lib/python3.9/site-packages/rpy2/robjects/__init__.py</span> in <span class="ansi-cyan-fg">__call__</span><span class="ansi-blue-fg">(self, string)</span>
<span class="ansi-green-intense-fg ansi-bold">    436</span>     <span class="ansi-green-fg">def</span> __call__<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">,</span> string<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">    437</span>         p <span class="ansi-blue-fg">=</span> rinterface<span class="ansi-blue-fg">.</span>parse<span class="ansi-blue-fg">(</span>string<span class="ansi-blue-fg">)</span>
<span class="ansi-green-fg">--&gt; 438</span><span class="ansi-red-fg">         </span>res <span class="ansi-blue-fg">=</span> self<span class="ansi-blue-fg">.</span>eval<span class="ansi-blue-fg">(</span>p<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    439</span>         <span class="ansi-green-fg">return</span> conversion<span class="ansi-blue-fg">.</span>rpy2py<span class="ansi-blue-fg">(</span>res<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    440</span> 

<span class="ansi-green-fg">~/opt/miniconda3/envs/biur/lib/python3.9/site-packages/rpy2/robjects/functions.py</span> in <span class="ansi-cyan-fg">__call__</span><span class="ansi-blue-fg">(self, *args, **kwargs)</span>
<span class="ansi-green-intense-fg ansi-bold">    196</span>                 v <span class="ansi-blue-fg">=</span> kwargs<span class="ansi-blue-fg">.</span>pop<span class="ansi-blue-fg">(</span>k<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    197</span>                 kwargs<span class="ansi-blue-fg">[</span>r_k<span class="ansi-blue-fg">]</span> <span class="ansi-blue-fg">=</span> v
<span class="ansi-green-fg">--&gt; 198</span><span class="ansi-red-fg">         return (super(SignatureTranslatedFunction, self)
</span><span class="ansi-green-intense-fg ansi-bold">    199</span>                 .__call__(*args, **kwargs))
<span class="ansi-green-intense-fg ansi-bold">    200</span> 

<span class="ansi-green-fg">~/opt/miniconda3/envs/biur/lib/python3.9/site-packages/rpy2/robjects/functions.py</span> in <span class="ansi-cyan-fg">__call__</span><span class="ansi-blue-fg">(self, *args, **kwargs)</span>
<span class="ansi-green-intense-fg ansi-bold">    123</span>             <span class="ansi-green-fg">else</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">    124</span>                 new_kwargs<span class="ansi-blue-fg">[</span>k<span class="ansi-blue-fg">]</span> <span class="ansi-blue-fg">=</span> conversion<span class="ansi-blue-fg">.</span>py2rpy<span class="ansi-blue-fg">(</span>v<span class="ansi-blue-fg">)</span>
<span class="ansi-green-fg">--&gt; 125</span><span class="ansi-red-fg">         </span>res <span class="ansi-blue-fg">=</span> super<span class="ansi-blue-fg">(</span>Function<span class="ansi-blue-fg">,</span> self<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">.</span>__call__<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">*</span>new_args<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">**</span>new_kwargs<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    126</span>         res <span class="ansi-blue-fg">=</span> conversion<span class="ansi-blue-fg">.</span>rpy2py<span class="ansi-blue-fg">(</span>res<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    127</span>         <span class="ansi-green-fg">return</span> res

<span class="ansi-green-fg">~/opt/miniconda3/envs/biur/lib/python3.9/site-packages/rpy2/rinterface_lib/conversion.py</span> in <span class="ansi-cyan-fg">_</span><span class="ansi-blue-fg">(*args, **kwargs)</span>
<span class="ansi-green-intense-fg ansi-bold">     43</span> <span class="ansi-green-fg">def</span> _cdata_res_to_rinterface<span class="ansi-blue-fg">(</span>function<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">     44</span>     <span class="ansi-green-fg">def</span> _<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">*</span>args<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">**</span>kwargs<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-fg">---&gt; 45</span><span class="ansi-red-fg">         </span>cdata <span class="ansi-blue-fg">=</span> function<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">*</span>args<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">**</span>kwargs<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">     46</span>         <span class="ansi-red-fg"># TODO: test cdata is of the expected CType</span>
<span class="ansi-green-intense-fg ansi-bold">     47</span>         <span class="ansi-green-fg">return</span> _cdata_to_rinterface<span class="ansi-blue-fg">(</span>cdata<span class="ansi-blue-fg">)</span>

<span class="ansi-green-fg">~/opt/miniconda3/envs/biur/lib/python3.9/site-packages/rpy2/rinterface.py</span> in <span class="ansi-cyan-fg">__call__</span><span class="ansi-blue-fg">(self, *args, **kwargs)</span>
<span class="ansi-green-intense-fg ansi-bold">    678</span>             )
<span class="ansi-green-intense-fg ansi-bold">    679</span>             <span class="ansi-green-fg">if</span> error_occured<span class="ansi-blue-fg">[</span><span class="ansi-cyan-fg">0</span><span class="ansi-blue-fg">]</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-fg">--&gt; 680</span><span class="ansi-red-fg">                 </span><span class="ansi-green-fg">raise</span> embedded<span class="ansi-blue-fg">.</span>RRuntimeError<span class="ansi-blue-fg">(</span>_rinterface<span class="ansi-blue-fg">.</span>_geterrmessage<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    681</span>         <span class="ansi-green-fg">return</span> res
<span class="ansi-green-intense-fg ansi-bold">    682</span> 

<span class="ansi-red-fg">RRuntimeError</span>: Error in rnorm(n, mean, var) : object &#39;n&#39; not found
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

</div>
 

